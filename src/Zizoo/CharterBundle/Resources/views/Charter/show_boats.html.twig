<div id="grid">
    {% for i in 0..page_size-1 %}
        {% if i < boats|length %}
            {% set boat = boats[i] %}
            <div class="boat">
                <div class="box">
                    <a href="{{ path('ZizooBoatBundle_Boat_Show', {id: boat.id}) }}" class="boat white clearfix">
                        <figure>
                            {% if boat.image.first != false %}
                                <img src="{{ asset(boat.image.first|pictureWebPath|imagine_filter('thumb_218x114')) }}" alt="" />
                            {% else %}
                                <img src="{{ asset('bundles/zizoobase/images/temp/galeon.jpg'|imagine_filter('thumb_218x114')) }}" alt="" />
                            {% endif %}

                            <figcaption class="clearfix">
                                {{ boat.title }}<span class="icon minus"></span>
                            </figcaption>
                        </figure>
                        <div class="left">
                            ?? Reviews
                        </div>
                        <div class="right">
                            from <strong>{{ boat|displayAmount(boat.lowestPrice) }} &euro;</strong>
                        </div>
                    </a>
                </div>
            </div>
        {% endif %}
    {% endfor %}
</div>
<input id="more_boats" type="hidden" value="{% if boats|length > page_size %}true{% else %}false{% endif %}" />
<a id="show_more_boats_link" href="{{ path('ZizooCharterBundle_Charter_ShowBoats', {id: charter.id, page: page+1}) }}" style="display: none">Show more &raquo;</a>
<img id="boats_loading" src="{{ asset('images/loader_16.gif') }}" style="display: none" />



<script type="text/javascript">
    $(document).ready(function(){
        {% if boats|length > page_size %}
        $('#show_more_boats_link').show().click(function(){
            $(this).hide();
            $('#boats_loading').show();
            var t = this;
            $.ajax({
                url: $(this).attr('href'),
                success: function(data){
                    $('#grid').append($(data).find('.box'));
                    $('#show_more_boats_link').attr('href', $(data).find('#show_more_boats_link'));
                    $('#boats_loading').hide();
                    if ($(data).find('#more_boats').val()=='true') $(this).show();
                }
            });
            return false;
        });
        {% endif %}
    });
</script>

